/**
 * Resize function without multiple trigger
 *
 * Usage:
 * $(window).smartresize(function(){
 *     // code here
 * });
 */
(function($,sr){
    // debouncing function from John Hann
    // http://unscriptable.com/index.php/2009/03/20/debouncing-javascript-methods/
    var debounce = function (func, threshold, execAsap) {
      var timeout;

        return function debounced () {
            var obj = this, args = arguments;
            function delayed () {
                if (!execAsap)
                    func.apply(obj, args);
                timeout = null;
            }

            if (timeout)
                clearTimeout(timeout);
            else if (execAsap)
                func.apply(obj, args);

            timeout = setTimeout(delayed, threshold || 100);
        };
    };

    // smartresize
    jQuery.fn[sr] = function(fn){  return fn ? this.bind('resize', debounce(fn)) : this.trigger(sr); };

})(jQuery,'smartresize');
var CURRENT_URL = window.location.href.split('#')[0].split('?')[0],
    $BODY = $('body'),
    $MENU_TOGGLE = $('#menu_toggle'),
    $SIDEBAR_MENU = $('#sidebar-menu'),
    $SIDEBAR_FOOTER = $('.sidebar-footer'),
    $LEFT_COL = $('.left_col'),
    $RIGHT_COL = $('.right_col'),
    $NAV_MENU = $('.nav_menu'),
    $FOOTER = $('footer');

// Sidebar
$(document).ready(function() {

    var setContentHeight = function () {
        // reset height
        $RIGHT_COL.css('min-height', $(window).height());

        var bodyHeight = $BODY.outerHeight(),
            footerHeight = $BODY.hasClass('footer_fixed') ? -10 : $FOOTER.height(),
            leftColHeight = $LEFT_COL.eq(1).height() + $SIDEBAR_FOOTER.height(),
            contentHeight = bodyHeight < leftColHeight ? leftColHeight : bodyHeight,
			screenHeight =  $(window).innerHeight();


        // normalize content
        contentHeight -= $NAV_MENU.height() + footerHeight - 90;


		if(screenHeight > contentHeight){
			 $RIGHT_COL.css('min-height', contentHeight);
		}else{
			  $RIGHT_COL.css('min-height', screenHeight - 80);
		}

    };

    $SIDEBAR_MENU.find('a').on('click', function(ev) {
        var $li = $(this).parent();

        if ($li.is('.active')) {
            $li.removeClass('active active-sm');
            $('ul:first', $li).slideUp(function() {
                setContentHeight();
            });
        } else {
            // prevent closing menu if we are on child menu
            if (!$li.parent().is('.child_menu')) {
                $SIDEBAR_MENU.find('li').removeClass('active active-sm');
                $SIDEBAR_MENU.find('li ul').slideUp();
            }

            $li.addClass('active');

            $('ul:first', $li).slideDown(function() {
                setContentHeight();
            });
        }
    });

    // toggle small or large menu
    $MENU_TOGGLE.on('click', function() {
        if ($BODY.hasClass('nav-md')) {
            $SIDEBAR_MENU.find('li.active ul').hide();
            $SIDEBAR_MENU.find('li.active').addClass('active-sm').removeClass('active');
        } else {
            $SIDEBAR_MENU.find('li.active-sm ul').show();
            $SIDEBAR_MENU.find('li.active-sm').addClass('active').removeClass('active-sm');
        }

        $BODY.toggleClass('nav-md nav-sm');

        setContentHeight();
    });

    // check active menu
    $SIDEBAR_MENU.find('a[href="' + CURRENT_URL + '"]').parent('li').addClass('current-page');

  if ($('body').hasClass('nav-md')){
    $SIDEBAR_MENU.find('a').filter(function () {
        return this.href == CURRENT_URL;
    }).parent('li').addClass('current-page').parents('ul').slideDown(function() {
        setContentHeight();
    }).parent().addClass('active');
  }


	$('.side-menu li').each(function(){
		if(!$(this).find('.child_menu').length){
			$(this).find('.fa').remove();
		}
	})

    // recompute content when resizing
    $(window).smartresize(function(){
        setContentHeight();
    });

    setContentHeight();

    // fixed sidebar
    //if ($.fn.mCustomScrollbar) {
        //$('.menu_fixed').mCustomScrollbar({
            // autoHideScrollbar: true,
            // theme: 'minimal',
      			// scrollInertia: 0,
      			// mouseWheelPixels: 170,
      			// autoDraggerLength:false,
            // mouseWheel:{ preventDefault: true }
        //});
    //}
});
//$(document).mouseup(function (e) {
    //var MenuContainer = $('.html-menuActive .main-menu'),
    //if (!MenuContainer.is(e.target) && MenuContainer.has(e.target).length === 0) {
        //Do Something
    //}
//});
// /Sidebar


//Debounce Resize Event
function debounce(func, wait, immediate) {
    var timeout;
    return function() {
        var context = this,
            args = arguments;
        var later = function() {
            timeout = null;
            if (!immediate) func.apply(context, args);
        };
        var callNow = immediate && !timeout;
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
        if (callNow) func.apply(context, args);
    };
};

var agentBalance =   $('.agent-balance').clone(),
	agentLocation =  $('.agent-location').clone();

var menuAdjustMobile = debounce(function() {
    var winWidth = $(window).innerWidth();
    var winheight = $(window).height();


    //Setting left menu max height
    //$('.menu_section').css('max-height', winheight - 500);

    //Appending agent balance to right menu in small screens
    if (winWidth < 768) {
        agentBalance.insertBefore('.dropdown-usermenu>li:first-child').wrap('<li />').fadeIn('fast');
		agentLocation.insertBefore('.dropdown-usermenu>li:first-child').wrap('<li />').fadeIn('fast');
    } else {
        //agentBalance.appendTo('#home-location').fadeIn('fast');
		//agentLocation.appendTo('.page-title .title_left').fadeIn('fast');
		$('.dropdown-usermenu>li .agent-location').remove();
		$('.dropdown-usermenu>li .agent-balance').remove();
    }

    //Iframe auto height
    var iframeHeight =  $('iframe').contents().height();
    $('iframe').css('height',iframeHeight);

    //Equal Height Common Script
    $('.eq-height-wrapper').each(function(){
        var highestBox = 0;

        $(this).find('.eq-height-div').each(function(){
            if($(this).height() > highestBox){
                highestBox = $(this).height();
            }
        })
        $(this).find('.eq-height-div').css('min-height',highestBox);
         if (winWidth < 991) {
       		   $(this).find('.eq-height-div').css('min-height','');
         }
		//For TranxVisa Page Table height
		var heightvalueinPX =  $('.documentsReq-table').attr('data-removeSpace');
        $('.documentsReq-table').css('max-height', highestBox - heightvalueinPX);
    });

	//Full Height Table
    var fullHeightTable = document.querySelectorAll('[data-fullpagetable]');
	for (var i = 0; i < fullHeightTable.length; i++) {
		var name = fullHeightTable[i].getAttribute('data-fullpagetable'),
		    name = $('[data-fullpagetable="'+ name + '"]');
		name.css('max-height',winheight - 300);
	}



}, 250);

//Calling Debounce Resize Event
window.addEventListener('resize', menuAdjustMobile);


// Panel toolbox
function panelToolbox() {
    $('.collapse-link').on('click', function () {
        var $BOX_PANEL = $(this).closest('.x_panel'),
            $ICON = $(this).find('i'),
            $BOX_CONTENT = $BOX_PANEL.find('.x_content');

        // fix for some div with hardcoded fix class
        if ($BOX_PANEL.attr('style')) {
            $BOX_CONTENT.slideToggle(200, function () {
                $BOX_PANEL.removeAttr('style');
            });
        } else {
            $BOX_CONTENT.slideToggle(200);
            $BOX_PANEL.css('height', 'auto');
        }

        $ICON.toggleClass('fa-chevron-up fa-chevron-down');
    });

    $('.close-link').click(function () {
        var $BOX_PANEL = $(this).closest('.x_panel');

        $BOX_PANEL.remove();
    });
}

// /Panel toolbox

// Tooltip
$(document).ready(function() {
    $('[data-toggle="tooltip"]').tooltip({
        container: 'body'
    });
	var mainMenuClone = $('#sidebar-menu .side-menu').clone();
	mainMenuClone.attr({
		'id' : 'topMenu',
		'class': 'top-main-menu'
	}).appendTo('.navbar-custom');
	$('.top-main-menu>li .child_menu').attr('class','top-child-menu');


});

//Custom Scrollbar init
(function($){
  $(window).load(function(){
  //  $(".menu_section").mCustomScrollbar({theme:"minimal"});
    //$('.right_col').mCustomScrollbar({ theme: 'minimal-dark' });
  });
})(jQuery);



//Control Buttons : wrapping div and adding icons with data attr.
function controlButtons() {
    $('.btn-control').each(function () {



    	//var isVisible = $(this).is(':visible');
    	//if((!$(this).parent().hasClass('btn-wrap')) && (isVisible === true)){
    	if((!$(this).parent().hasClass('btn-wrap')) ){
			 $(this).wrapAll('<div class="btn-wrap" />');

			 if ($(this).attr('data-icon')) {
	            var dataIcon = $(this).data("icon");
	            $(this).closest('.btn-wrap').append('<i class="icon ' + dataIcon + '">');
	            if($(this).next('.icon').hasClass('icon-right')){
					$(this).closest('.btn-wrap').addClass("btn-icon-right");
				}
	        }
		}
		var hiddenbtnCntrl = $(this).attr('style');
		if(hiddenbtnCntrl === 'display:none')    {
			$(this).next('.icon').hide();
		}
    })
    //Only for asp command field Button
    $('.cmmField-btn-edit').each(function () {
        $(this).closest('.btn-wrap').append('<i class="icon fa fa-edit">');
    })
}

//Custom Select Wrapper
function selectWrapper() {
    $('select').each(function () {
//        if ($(this).parent().hasClass('custom-select') || $(this).parent().hasClass('custom-select2')) {
//        } else {
//            $(this).wrap('<div class="custom-select" />')
//            $(this).addClass('form-control')
//        }
		if(!$(this).attr("multiple")){

			 if ($(this).parent().hasClass('custom-select') || $(this).parent().hasClass('custom-select2') || $(this).hasClass('scwHead') ) {
			 } else {
				$(this).wrap('<div class="custom-select" />')
				//$(this).addClass('form-control')
			 }
			$(this).addClass('form-control')
		}
    })
}

function siteCommon() {
	//Adding form control to all input elems inside table
    $('.table-structure input').addClass('form-control');

    //date control check
    $('.date-control-input').each(function () {
        if ($(this).find('.form-control').hasClass('time') && $(this).find('.form-control').hasClass('date')  ) {
            $(this).addClass('dateNtime');
        } else if($(this).find('.form-control').hasClass('time')) {
            $(this).addClass('timeOnly');
        } else if($(this).find('.form-control').hasClass('date')) {
            $(this).addClass('dateOnly');
        }
    })
    //For Adding Filter Icons - Image Button
     $('.filter-wrapper input[type=image]').each(function () {

       	if(!$(this).parent().hasClass('filter-wrap')){
  			$(this).wrapAll('<div class="filter-wrap" />').addClass('img-input');
         		//$(this).removeAttr('src', '');
  			$('.filter-wrapper input[type=image][alt="Advance Filter"]').parent().addClass('adv-filter');
        $(this).attr('src', 'images/filter-icon.png');
		}
    })
	$('.filter-wrapper .filterHeaderText').css('width','');

   //Common Checkbox: Checking if disabled/checked
   $('input[type=checkbox]').each(function(){
   	   if($(this).is(':checked')){
	      $(this).closest('.custom-checkbox').addClass("active-check");
	   }else if($(this).is(':disabled')){
	   	 $(this).closest('.custom-checkbox').addClass("disabled");
	   }
	    else{
	        $(this).closest('.custom-checkbox').removeClass("active-check");
	   }
   	   $(this).change(function () {
        if ($(this).is(":checked")) {
            $(this).closest('.custom-checkbox').addClass("active-check");
        } else {
            $(this).closest('.custom-checkbox').removeClass("active-check");
        }
    });
   });

  //SELECT2 ELEMENT
	$('.custom-select select,.custom-select2 select').select2();

	//$('.scw.date-control select').select2('destroy');


    //Keeping control buttons and titles stickey when scrolled   - TEMPORARILY COMMENTED - 15.10 / 05 MAR 2017
	//    if($('.page-title').length){
	//        var $obj = $('.page-title');
	//		var $topposition = $obj.offset().top - parseFloat($obj.css('marginTop').replace(/auto/, 0));
	//		$(window).scroll(function (event) {
	//		// what the y position of the scroll is
	//	    	var y = $(this).scrollTop();
	//			// whether that's below the form
	//			if (y >= $topposition) {
	//			  // if so, ad the fixed class
	//			  $obj.addClass('fixed');
	//			} else {
	//			  // otherwise remove it
	//			  $obj.removeClass('fixed');
	//			}
	//		});
	//	}

    //Left menu quick fixes
	//$('.nav.side-menu>li.active').attr('class','active-sm');
	//$('.nav.side-menu>li.active-sm .nav.child_menu').hide();


    // Expand collapse only used in TranxVisaSales.aspx
     $('.add-more-accordion .panel-heading').click(function(){
    	if($('.add-more-accordion .panel-collapse.collapse').hasClass('in')){
			$('.add-more-accordion .panel-heading .fa').attr('class','fa fa-plus-circle');
		}else{
			 $('.add-more-accordion .panel-heading .fa').attr('class','fa fa-minus-circle');
		}

     });

     //getting page title and applying it to body as class name
	  var pageTitle = document.getElementsByTagName("title")[0].innerHTML;
        pageTitle = pageTitle.replace(/\s+/g, '').toLowerCase();
        if(!$BODY.hasClass(pageTitle)){
			       $BODY.addClass('page-' + pageTitle);
	      }

     //Show Param Toggle Arrows
     $('.show-param-btn').click(function(){
     	if($(this).text().indexOf("Hide Param") >= 0){
			$(this).next('.icon').attr('class','icon vms-icon-keyboard_arrow_down');
		}else{
			$(this).next('.icon').attr('class','icon vms-icon-keyboard_arrow_up');
		}
     });


	  $('.filter-wrapper>th table>tbody').each(function(){
		  var firstElm = $(this).children('tr:first-child'),
			  SecElm = $(this).children('tr:last-child');
			  SecElm.insertBefore(firstElm);
	 })





} //END of siteCommon Function


$(document).ready(function () {
	$('.hide-top-bar').on('click',function(){
		$BODY.toggleClass('hidden-top-bar');
	})
    // Accordion
    $(".expand").on("click", function () {
        $(this).next().slideToggle(200);
        $expand = $(this).find(">:first-child");
        if ($expand.text() == "+") {
            $expand.text("-");
        } else {
            $expand.text("+");
        }
    });
	$(document).on('blur','.form-text-error',function(){
		$(this).removeClass('form-text-error');
	})
	$(document).on('blur','.form-border-color',function(){
		$(this).removeClass('form-border-color');
	})


    controlButtons();
    selectWrapper();
    siteCommon();
    panelToolbox();
    menuAdjustMobile();
});
$(document).mouseup(function (e) {
    var MenuContainer = $('.nav-sm #sidebar-menu');

       if (!MenuContainer.is(e.target) && MenuContainer.has(e.target).length === 0) {
          $('.nav-sm #sidebar-menu').find('li').removeClass('active active-sm');
          $('.nav-sm #sidebar-menu').find('li ul').slideUp();
       }

});



// NProgress: page loading"
if (typeof NProgress != 'undefined') {
    $(document).ready(function () {
        NProgress.start();
    });

    $(window).load(function () {
        NProgress.done();
    });
}

/*
 * Toastr
 * Copyright 2012-2015
 * Authors: John Papa, Hans Fjï¿½llemark, and Tim Ferrell.
 * All Rights Reserved.
 * Use, reproduction, distribution, and modification of this code is subject to the terms and
 * conditions of the MIT license, available at http://www.opensource.org/licenses/mit-license.php
 *
 * ARIA Support: Greta Krafsig
 *
 * Project: https://github.com/CodeSeven/toastr
 */
/* global define */
!function (e) { e(["jquery"], function (e) { return function () { function t(e, t, n) { return g({ type: O.error, iconClass: m().iconClasses.error, message: e, optionsOverride: n, title: t }) } function n(t, n) { return t || (t = m()), v = e("#" + t.containerId), v.length ? v : (n && (v = d(t)), v) } function o(e, t, n) { return g({ type: O.info, iconClass: m().iconClasses.info, message: e, optionsOverride: n, title: t }) } function s(e) { C = e } function i(e, t, n) { return g({ type: O.success, iconClass: m().iconClasses.success, message: e, optionsOverride: n, title: t }) } function a(e, t, n) { return g({ type: O.warning, iconClass: m().iconClasses.warning, message: e, optionsOverride: n, title: t }) } function r(e, t) { var o = m(); v || n(o), u(e, o, t) || l(o) } function c(t) { var o = m(); return v || n(o), t && 0 === e(":focus", t).length ? void h(t) : void (v.children().length && v.remove()) } function l(t) { for (var n = v.children(), o = n.length - 1; o >= 0; o--) u(e(n[o]), t) } function u(t, n, o) { var s = !(!o || !o.force) && o.force; return !(!t || !s && 0 !== e(":focus", t).length) && (t[n.hideMethod]({ duration: n.hideDuration, easing: n.hideEasing, complete: function () { h(t) } }), !0) } function d(t) { return v = e("<div/>").attr("id", t.containerId).addClass(t.positionClass), v.appendTo(e(t.target)), v } function p() { return { tapToDismiss: !0, toastClass: "toast", containerId: "toast-container", debug: !1, showMethod: "fadeIn", showDuration: 300, showEasing: "swing", onShown: void 0, hideMethod: "fadeOut", hideDuration: 1e3, hideEasing: "swing", onHidden: void 0, closeMethod: !1, closeDuration: !1, closeEasing: !1, closeOnHover: !0, extendedTimeOut: 1e3, iconClasses: { error: "toast-error", info: "toast-info", success: "toast-success", warning: "toast-warning" }, iconClass: "toast-info", positionClass: "toast-top-right", timeOut: 5e3, titleClass: "toast-title", messageClass: "toast-message", escapeHtml: !1, target: "body", closeHtml: '<button type="button">&times;</button>', closeClass: "toast-close-button", newestOnTop: !0, preventDuplicates: !1, progressBar: !1, progressClass: "toast-progress", rtl: !1 } } function f(e) { C && C(e) } function g(t) { function o(e) { return null == e && (e = ""), e.replace(/&/g, "&amp;").replace(/"/g, "&quot;").replace(/'/g, "&#39;").replace(/</g, "&lt;").replace(/>/g, "&gt;") } function s() { c(), u(), d(), p(), g(), C(), l(), i() } function i() { var e = ""; switch (t.iconClass) { case "toast-success": case "toast-info": e = "polite"; break; default: e = "assertive" } I.attr("aria-live", e) } function a() { E.closeOnHover && I.hover(H, D), !E.onclick && E.tapToDismiss && I.click(b), E.closeButton && j && j.click(function (e) { e.stopPropagation ? e.stopPropagation() : void 0 !== e.cancelBubble && e.cancelBubble !== !0 && (e.cancelBubble = !0), E.onCloseClick && E.onCloseClick(e), b(!0) }), E.onclick && I.click(function (e) { E.onclick(e), b() }) } function r() { I.hide(), I[E.showMethod]({ duration: E.showDuration, easing: E.showEasing, complete: E.onShown }), E.timeOut > 0 && (k = setTimeout(b, E.timeOut), F.maxHideTime = parseFloat(E.timeOut), F.hideEta = (new Date).getTime() + F.maxHideTime, E.progressBar && (F.intervalId = setInterval(x, 10))) } function c() { t.iconClass && I.addClass(E.toastClass).addClass(y) } function l() { E.newestOnTop ? v.prepend(I) : v.append(I) } function u() { if (t.title) { var e = t.title; E.escapeHtml && (e = o(t.title)), M.append(e).addClass(E.titleClass), I.append(M) } } function d() { if (t.message) { var e = t.message; E.escapeHtml && (e = o(t.message)), B.append(e).addClass(E.messageClass), I.append(B) } } function p() { E.closeButton && (j.addClass(E.closeClass).attr("role", "button"), I.prepend(j)) } function g() { E.progressBar && (q.addClass(E.progressClass), I.prepend(q)) } function C() { E.rtl && I.addClass("rtl") } function O(e, t) { if (e.preventDuplicates) { if (t.message === w) return !0; w = t.message } return !1 } function b(t) { var n = t && E.closeMethod !== !1 ? E.closeMethod : E.hideMethod, o = t && E.closeDuration !== !1 ? E.closeDuration : E.hideDuration, s = t && E.closeEasing !== !1 ? E.closeEasing : E.hideEasing; if (!e(":focus", I).length || t) return clearTimeout(F.intervalId), I[n]({ duration: o, easing: s, complete: function () { h(I), clearTimeout(k), E.onHidden && "hidden" !== P.state && E.onHidden(), P.state = "hidden", P.endTime = new Date, f(P) } }) } function D() { (E.timeOut > 0 || E.extendedTimeOut > 0) && (k = setTimeout(b, E.extendedTimeOut), F.maxHideTime = parseFloat(E.extendedTimeOut), F.hideEta = (new Date).getTime() + F.maxHideTime) } function H() { clearTimeout(k), F.hideEta = 0, I.stop(!0, !0)[E.showMethod]({ duration: E.showDuration, easing: E.showEasing }) } function x() { var e = (F.hideEta - (new Date).getTime()) / F.maxHideTime * 100; q.width(e + "%") } var E = m(), y = t.iconClass || E.iconClass; if ("undefined" != typeof t.optionsOverride && (E = e.extend(E, t.optionsOverride), y = t.optionsOverride.iconClass || y), !O(E, t)) { T++, v = n(E, !0); var k = null, I = e("<div/>"), M = e("<div/>"), B = e("<div/>"), q = e("<div/>"), j = e(E.closeHtml), F = { intervalId: null, hideEta: null, maxHideTime: null }, P = { toastId: T, state: "visible", startTime: new Date, options: E, map: t }; return s(), r(), a(), f(P), E.debug && console && console.log(P), I } } function m() { return e.extend({}, p(), b.options) } function h(e) { v || (v = n()), e.is(":visible") || (e.remove(), e = null, 0 === v.children().length && (v.remove(), w = void 0)) } var v, C, w, T = 0, O = { error: "error", info: "info", success: "success", warning: "warning" }, b = { clear: r, remove: c, error: t, getContainer: n, info: o, options: {}, subscribe: s, success: i, version: "2.1.4", warning: a }; return b }() }) }("function" == typeof define && define.amd ? define : function (e, t) { "undefined" != typeof module && module.exports ? module.exports = t(require("jquery")) : window.toastr = t(window.jQuery) });
//# sourceMappingURL=toastr.js.map

toastr.options = {
    "closeButton": true,
    "debug": false,
    "newestOnTop": true,
    "progressBar": false,
    "positionClass": "toast-top-right",
    "preventDuplicates": false,
    "onclick": null,
    "showDuration": "300",
    "hideDuration": "1000",
    "timeOut": "5000",
    "extendedTimeOut": "1000",
    "showEasing": "swing",
    "hideEasing": "linear",
    "showMethod": "slideDown",
    "hideMethod": "slideUp"
}
